<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Clear erroneous archivist artifacts — clearStubArtifacts â€¢ reproducible</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58633549-5', 'auto');
  ga('send', 'pageview');

</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">reproducible</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/reproducible">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Clear erroneous archivist artifacts</h1>
    </div>

    
    <p>Stub artifacts can result from several causes. The most common being
erroneous removal of a file in the sqlite database. This can be caused
sometimes if an archive object is being saved multiple times by multiple
threads. This function will clear entries in the sqlite database which
have no actual file with data.</p>
    

    <pre class="usage"><span class='fu'>clearStubArtifacts</span>(<span class='kw'>repoDir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='co'># S4 method for ANY</span>
<span class='fu'>clearStubArtifacts</span>(<span class='kw'>repoDir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>repoDir</th>
      <td><p>A character denoting an existing directory of the repository for
which metadata will be returned. If <code>NULL</code> (default), it will use the
<code>repoDir</code> specified in <code><a href='http://www.rdocumentation.org/packages/archivist/topics/setRepo'>archivist::setLocalRepo</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Invoked for its side effect on the <code>repoDir</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>tmpDir</span> <span class='kw'>&lt;-</span> <span class='fu'>file.path</span>(<span class='fu'>tempdir</span>(), <span class='st'>"reproducible_examples"</span>, <span class='st'>"clearStubArtifacts"</span>)

<span class='fu'>lapply</span>(<span class='fu'>c</span>(<span class='no'>runif</span>, <span class='no'>rnorm</span>), <span class='kw'>function</span>(<span class='no'>f</span>) {
  <span class='kw pkg'>reproducible</span><span class='kw ns'>::</span><span class='fu'><a href='http://reproducible.predictiveecology.org/reference/cache.html'>Cache</a></span>(<span class='no'>f</span>, <span class='fl'>10</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)
})</div><div class='output co'>#&gt; [[1]]
#&gt;  [1] 0.6865692 0.1636232 0.9528248 0.3218546 0.3615341 0.8877234 0.8280144
#&gt;  [8] 0.1006565 0.9060516 0.7727304
#&gt; attr(,"tags")
#&gt; [1] "cacheId:c69b2b95bcd43bf312ca6d89049726f4"
#&gt; attr(,"call")
#&gt; [1] ""
#&gt; 
#&gt; [[2]]
#&gt;  [1] -0.2966400 -0.3872136 -0.7854327 -1.0567369 -0.7955414 -1.7562754
#&gt;  [7] -0.6905379 -0.5585420 -0.5366633  0.2271271
#&gt; attr(,"tags")
#&gt; [1] "cacheId:7428e865f914063acaf23ecc7c817315"
#&gt; attr(,"call")
#&gt; [1] ""
#&gt; </div><div class='input'>
<span class='co'># clear out any stub artifacts</span>
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>)</div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 09a4f143d744044c0c8e2e60c6d5fbbb         format
#&gt;  2: 09a4f143d744044c0c8e2e60c6d5fbbb           name
#&gt;  3: 09a4f143d744044c0c8e2e60c6d5fbbb          class
#&gt;  4: 09a4f143d744044c0c8e2e60c6d5fbbb           date
#&gt;  5: 09a4f143d744044c0c8e2e60c6d5fbbb       function
#&gt;  6: 09a4f143d744044c0c8e2e60c6d5fbbb    object.size
#&gt;  7: 09a4f143d744044c0c8e2e60c6d5fbbb       accessed
#&gt;  8: 09a4f143d744044c0c8e2e60c6d5fbbb otherFunctions
#&gt;  9: 09a4f143d744044c0c8e2e60c6d5fbbb otherFunctions
#&gt; 10: 09a4f143d744044c0c8e2e60c6d5fbbb otherFunctions
#&gt; 11: 09a4f143d744044c0c8e2e60c6d5fbbb        cacheId
#&gt; 12: b372b382fe0902130b2848f82546618d         format
#&gt; 13: b372b382fe0902130b2848f82546618d           name
#&gt; 14: b372b382fe0902130b2848f82546618d          class
#&gt; 15: b372b382fe0902130b2848f82546618d           date
#&gt; 16: b372b382fe0902130b2848f82546618d       function
#&gt; 17: b372b382fe0902130b2848f82546618d    object.size
#&gt; 18: b372b382fe0902130b2848f82546618d       accessed
#&gt; 19: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 20: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 21: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 22: b372b382fe0902130b2848f82546618d        cacheId
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:51
#&gt;  2:                               Cache 2018-01-25 08:47:51
#&gt;  3:                             numeric 2018-01-25 08:47:51
#&gt;  4:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt;  5:                                   f 2018-01-25 08:47:51
#&gt;  6:                                 624 2018-01-25 08:47:51
#&gt;  7:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt;  8:      otherFunctions:build_reference 2018-01-25 08:47:51
#&gt;  9: otherFunctions:data_reference_topic 2018-01-25 08:47:51
#&gt; 10:                  otherFunctions:try 2018-01-25 08:47:51
#&gt; 11:    c69b2b95bcd43bf312ca6d89049726f4 2018-01-25 08:47:51
#&gt; 12:                                 rda 2018-01-25 08:47:51
#&gt; 13:                               Cache 2018-01-25 08:47:51
#&gt; 14:                             numeric 2018-01-25 08:47:51
#&gt; 15:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt; 16:                                   f 2018-01-25 08:47:51
#&gt; 17:                                 624 2018-01-25 08:47:51
#&gt; 18:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt; 19:      otherFunctions:build_reference 2018-01-25 08:47:51
#&gt; 20: otherFunctions:data_reference_topic 2018-01-25 08:47:51
#&gt; 21:                  otherFunctions:try 2018-01-25 08:47:51
#&gt; 22:    7428e865f914063acaf23ecc7c817315 2018-01-25 08:47:51
#&gt;                                tagValue         createdDate</div><div class='input'>
<span class='no'>file2Remove</span> <span class='kw'>&lt;-</span> <span class='fu'>dir</span>(<span class='fu'>file.path</span>(<span class='no'>tmpDir</span>, <span class='st'>"gallery"</span>), <span class='kw'>full.name</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)[<span class='fl'>1</span>]
<span class='fu'>file.remove</span>(<span class='no'>file2Remove</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>) <span class='co'># repository directory still thinks files are there</span></div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 09a4f143d744044c0c8e2e60c6d5fbbb         format
#&gt;  2: 09a4f143d744044c0c8e2e60c6d5fbbb           name
#&gt;  3: 09a4f143d744044c0c8e2e60c6d5fbbb          class
#&gt;  4: 09a4f143d744044c0c8e2e60c6d5fbbb           date
#&gt;  5: 09a4f143d744044c0c8e2e60c6d5fbbb       function
#&gt;  6: 09a4f143d744044c0c8e2e60c6d5fbbb    object.size
#&gt;  7: 09a4f143d744044c0c8e2e60c6d5fbbb       accessed
#&gt;  8: 09a4f143d744044c0c8e2e60c6d5fbbb otherFunctions
#&gt;  9: 09a4f143d744044c0c8e2e60c6d5fbbb otherFunctions
#&gt; 10: 09a4f143d744044c0c8e2e60c6d5fbbb otherFunctions
#&gt; 11: 09a4f143d744044c0c8e2e60c6d5fbbb        cacheId
#&gt; 12: b372b382fe0902130b2848f82546618d         format
#&gt; 13: b372b382fe0902130b2848f82546618d           name
#&gt; 14: b372b382fe0902130b2848f82546618d          class
#&gt; 15: b372b382fe0902130b2848f82546618d           date
#&gt; 16: b372b382fe0902130b2848f82546618d       function
#&gt; 17: b372b382fe0902130b2848f82546618d    object.size
#&gt; 18: b372b382fe0902130b2848f82546618d       accessed
#&gt; 19: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 20: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 21: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 22: b372b382fe0902130b2848f82546618d        cacheId
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:51
#&gt;  2:                               Cache 2018-01-25 08:47:51
#&gt;  3:                             numeric 2018-01-25 08:47:51
#&gt;  4:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt;  5:                                   f 2018-01-25 08:47:51
#&gt;  6:                                 624 2018-01-25 08:47:51
#&gt;  7:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt;  8:      otherFunctions:build_reference 2018-01-25 08:47:51
#&gt;  9: otherFunctions:data_reference_topic 2018-01-25 08:47:51
#&gt; 10:                  otherFunctions:try 2018-01-25 08:47:51
#&gt; 11:    c69b2b95bcd43bf312ca6d89049726f4 2018-01-25 08:47:51
#&gt; 12:                                 rda 2018-01-25 08:47:51
#&gt; 13:                               Cache 2018-01-25 08:47:51
#&gt; 14:                             numeric 2018-01-25 08:47:51
#&gt; 15:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt; 16:                                   f 2018-01-25 08:47:51
#&gt; 17:                                 624 2018-01-25 08:47:51
#&gt; 18:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt; 19:      otherFunctions:build_reference 2018-01-25 08:47:51
#&gt; 20: otherFunctions:data_reference_topic 2018-01-25 08:47:51
#&gt; 21:                  otherFunctions:try 2018-01-25 08:47:51
#&gt; 22:    7428e865f914063acaf23ecc7c817315 2018-01-25 08:47:51
#&gt;                                tagValue         createdDate</div><div class='input'>
<span class='co'># run clearStubArtifacts</span>
<span class='fu'>suppressWarnings</span>(<span class='fu'>clearStubArtifacts</span>(<span class='no'>tmpDir</span>))
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>) <span class='co'># stubs are removed</span></div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: b372b382fe0902130b2848f82546618d         format
#&gt;  2: b372b382fe0902130b2848f82546618d           name
#&gt;  3: b372b382fe0902130b2848f82546618d          class
#&gt;  4: b372b382fe0902130b2848f82546618d           date
#&gt;  5: b372b382fe0902130b2848f82546618d       function
#&gt;  6: b372b382fe0902130b2848f82546618d    object.size
#&gt;  7: b372b382fe0902130b2848f82546618d       accessed
#&gt;  8: b372b382fe0902130b2848f82546618d otherFunctions
#&gt;  9: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 10: b372b382fe0902130b2848f82546618d otherFunctions
#&gt; 11: b372b382fe0902130b2848f82546618d        cacheId
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:51
#&gt;  2:                               Cache 2018-01-25 08:47:51
#&gt;  3:                             numeric 2018-01-25 08:47:51
#&gt;  4:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt;  5:                                   f 2018-01-25 08:47:51
#&gt;  6:                                 624 2018-01-25 08:47:51
#&gt;  7:                 2018-01-25 08:47:51 2018-01-25 08:47:51
#&gt;  8:      otherFunctions:build_reference 2018-01-25 08:47:51
#&gt;  9: otherFunctions:data_reference_topic 2018-01-25 08:47:51
#&gt; 10:                  otherFunctions:try 2018-01-25 08:47:51
#&gt; 11:    7428e865f914063acaf23ecc7c817315 2018-01-25 08:47:51</div><div class='input'>
<span class='co'># cleanup</span>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>)
<span class='fu'>unlink</span>(<span class='no'>tmpDir</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Eliot McIntire

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
