<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cache method that accommodates environments, S4 methods, Rasters — Cache â€¢ reproducible</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58633549-5', 'auto');
  ga('send', 'pageview');

</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">reproducible</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/reproducible">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cache method that accommodates environments, S4 methods, Rasters</h1>
    </div>

    
    <p>Cache method that accommodates environments, S4 methods, Rasters</p>
    

    <pre class="usage"><span class='fu'>Cache</span>(<span class='no'>FUN</span>, <span class='no'>...</span>, <span class='kw'>notOlderThan</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>objects</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>outputObjects</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>algo</span> <span class='kw'>=</span> <span class='st'>"xxhash64"</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>compareRasterFileLength</span> <span class='kw'>=</span> <span class='fl'>1e+06</span>,
  <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>c</span>(), <span class='kw'>digestPathContent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>omitArgs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>classOptions</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='kw'>debugCache</span> <span class='kw'>=</span> <span class='fu'>character</span>(), <span class='kw'>sideEffect</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>makeCopy</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>quick</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S4 method for ANY</span>
<span class='fu'>Cache</span>(<span class='no'>FUN</span>, <span class='no'>...</span>, <span class='kw'>notOlderThan</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>objects</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>outputObjects</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>algo</span> <span class='kw'>=</span> <span class='st'>"xxhash64"</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>compareRasterFileLength</span> <span class='kw'>=</span> <span class='fl'>1e+06</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>c</span>(),
  <span class='kw'>digestPathContent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>omitArgs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>classOptions</span> <span class='kw'>=</span> <span class='fu'>list</span>(),
  <span class='kw'>debugCache</span> <span class='kw'>=</span> <span class='fu'>character</span>(), <span class='kw'>sideEffect</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>makeCopy</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>quick</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>FUN</th>
      <td><p>Either a function or an unevaluated function call (e.g., using
<code>quote</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments of <code>FUN</code> function .</p></td>
    </tr>
    <tr>
      <th>notOlderThan</th>
      <td><p>load an artifact from the database only if it was created after notOlderThan.</p></td>
    </tr>
    <tr>
      <th>objects</th>
      <td><p>Character vector of objects to be digested. This is only applicable
if there is a list, environment or simList with named objects
within it. Only this/these objects will be considered for caching,
i.e., only use a subset of
the list, environment or simList objects.</p></td>
    </tr>
    <tr>
      <th>outputObjects</th>
      <td><p>Optional character vector indicating which objects to
return. This is only relevant for <code>simList</code> objects</p></td>
    </tr>
    <tr>
      <th>algo</th>
      <td><p>The algorithms to be used; currently available choices are
    <code>md5</code>, which is also the default, <code>sha1</code>, <code>crc32</code>,
    <code>sha256</code>, <code>sha512</code>, <code>xxhash32</code>, <code>xxhash64</code> and
    <code>murmur32</code>.</p></td>
    </tr>
    <tr>
      <th>cacheRepo</th>
      <td><p>A repository used for storing cached objects.
This is optional if <code>Cache</code> is used inside a SpaDES module.</p></td>
    </tr>
    <tr>
      <th>compareRasterFileLength</th>
      <td><p>Numeric. Optional. When there are Rasters, that
have file-backed storage, this is passed to the length arg in <code>digest</code>
when determining if the Raster file is already in the database.
Note: uses <code><a href='http://www.rdocumentation.org/packages/digest/topics/digest'>digest</a></code> for file-backed Raster.
Default 1e6. Passed to <code>.prepareFileBackedRaster</code>.</p></td>
    </tr>
    <tr>
      <th>userTags</th>
      <td><p>A character vector with Tags. These Tags will be added to the repository along with the artifact.</p></td>
    </tr>
    <tr>
      <th>digestPathContent</th>
      <td><p>Logical. Should arguments that are of class <code>Path</code>
(see examples below) have their name digested
(<code>FALSE</code>), or their file contents (<code>TRUE</code>; default).</p></td>
    </tr>
    <tr>
      <th>omitArgs</th>
      <td><p>Optional character string of arguments in the FUN to omit from the digest.</p></td>
    </tr>
    <tr>
      <th>classOptions</th>
      <td><p>Optional list. This will pass into <code>.robustDigest</code> for
specific classes. Should be options that the <code>.robustDigest</code> knows what
to do with.</p></td>
    </tr>
    <tr>
      <th>debugCache</th>
      <td><p>Character or Logical. Either <code>"complete"</code> or <code>"quick"</code> (uses
partial matching, so "c" or "q" work). <code>TRUE</code> is
equivalent to <code>"complete"</code>.
If <code>"complete"</code>, then the returned object from the Cache
function will have two attributes, <code>debugCache1</code> and <code>debugCache2</code>,
which are the entire <code>list(...)</code> and that same object, but after all
<code>.robustDigest</code> calls, at the moment that it is digested using
<code>fastdigest</code>, respectively. This <code>attr(mySimOut, "debugCache2")</code>
can then be compared to a subsequent call and individual items within
the object <code>attr(mySimOut, "debugCache1")</code> can be compared.
If <code>"quick"</code>, then it will return the same two objects directly,
without evalutating the <code>FUN(...)</code>.</p></td>
    </tr>
    <tr>
      <th>sideEffect</th>
      <td><p>Logical or path. Deteremines where the function will look for
new files following function completion. See Details.
<em>NOTE: this argument is experimental and may change in future releases.</em></p></td>
    </tr>
    <tr>
      <th>makeCopy</th>
      <td><p>Logical. If <code>sideEffect = TRUE</code>, and <code>makeCopy = TRUE</code>,
a copy of the downloaded files will be made and stored in the <code>cacheRepo</code>
to speed up subsequent file recovery in the case where the original copy
of the downloaded files are corrupted or missing. Currently only works when
set to <code>TRUE</code> during the first run of <code>Cache</code>. Default is <code>FALSE</code>.
<em>NOTE: this argument is experimental and may change in future releases.</em></p></td>
    </tr>
    <tr>
      <th>quick</th>
      <td><p>Logical. If <code>sideEffect = TRUE</code>, setting this to <code>TRUE</code>,
will hash the file's metadata (i.e., filename and file size) instead of
hashing the contents of the file(s). If set to <code>FALSE</code> (default),
the contents of the file(s) are hashed.
<em>NOTE: this argument is experimental and may change in future releases.</em></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>As with <code><a href='http://www.rdocumentation.org/packages/archivist/topics/cache'>cache</a></code>, returns the value of the
function call or the cached version (i.e., the result from a previous call
to this same cached function with identical arguments).</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Caching R objects using <code><a href='http://www.rdocumentation.org/packages/archivist/topics/cache'>cache</a></code> has four important limitations:</p><ol>
<li><p>the <code>archivist</code> package detects different environments as different;</p></li>
<li><p>it also does not detect S4 methods correctly due to method inheritance;</p></li>
<li><p>it does not detect objects that have file-base storage of information
        (specifically <code><a href='http://www.rdocumentation.org/packages/raster/topics/Raster-classes'>RasterLayer-class</a></code> objects);</p></li>
<li><p>the default hashing algorithm is relatively slow.</p></li>
</ol><p>This version of the <code>Cache</code> function accommodates those four special,
though quite common, cases by:</p><ol>
<li><p>converting any environments into list equivalents;</p></li>
<li><p>identifying the dispatched S4 method (including those made through
        inheritance) before hashing so the correct method is being cached;</p></li>
<li><p>by hashing the linked file, rather than the Raster object.
        Currently, only file-backed <code>Raster*</code> objects are digested
        (e.g., not <code>ff</code> objects, or any other R object where the data
        are on disk instead of in RAM);</p></li>
<li><p>using <code><a href='http://www.rdocumentation.org/packages/fastdigest/topics/fastdigest'>fastdigest</a></code> internally when the object
        is in RAM, which can be up to ten times faster than
        <code><a href='http://www.rdocumentation.org/packages/digest/topics/digest'>digest</a></code>. Note that file-backed objects are still
        hashed using <code><a href='http://www.rdocumentation.org/packages/digest/topics/digest'>digest</a></code>.</p></li>
</ol>
    <p>If <code>Cache</code> is called within a SpaDES module, then the cached entry will automatically
get 3 extra <code>userTags</code>: <code>eventTime</code>, <code>eventType</code>, and <code>moduleName</code>.
These can then be used in <code>clearCache</code> to selectively remove cached objects
by <code>eventTime</code>, <code>eventType</code> or <code>moduleName</code>.
    <code>Cache</code> will add a tag to the artifact in the database called <code>accessed</code>,
which will assign the time that it was accessed, either read or write.
That way, artifacts can be shown (using <code>showCache</code>) or removed (using
<code>clearCache</code>) selectively, based on their access dates, rather than only
by their creation dates. See example in <code><a href='viewCache.html'>clearCache</a></code>.
<code>Cache</code> (uppercase C) is used here so that it is not confused with, and does
not mask, the <code><a href='http://www.rdocumentation.org/packages/archivist/topics/cache'>archivist::cache</a></code> function.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>As indicated above, several objects require pre-treatment before
caching will work as expected. The function <code>.robustDigest</code> accommodates this.
It is an S4 generic, meaning that developers can produce their own methods for
different classes of objects. Currently, there are methods for several types
of classes. See <code><a href='robustDigest.html'>.robustDigest</a></code>.</p>
<p>See <code><a href='robustDigest.html'>.robustDigest</a></code> for other specifics for other classes.</p>
    
    <h2 class="hasAnchor" id="filepaths"><a class="anchor" href="#filepaths"></a>Filepaths</h2>

    
    <p>If a function has a path argument, there is some ambiguity about what should be
done. Possibilities include:</p><ol>
<li><p>hash the string as is (this will be very system specific, meaning a
        <code>Cache</code> call will not work if copied between systems or directories);</p></li>
<li><p>hash the <code>basename(path)</code>;</p></li>
<li><p>hash the contents of the file.</p></li>
</ol><p>If paths are passed in as is (i.e,. character string), the result will not be predictable.
Instead, one should use the wrapper function <code>asPath(path)</code>, which sets the
class of the string to a <code>Path</code>, and one should decide whether one wants
to digest the content of the file (using <code>digestPathContent = TRUE</code>),
or just the filename (<code>(digestPathContent = FALSE)</code>). See examples.</p>
    
    <h2 class="hasAnchor" id="stochasticity"><a class="anchor" href="#stochasticity"></a>Stochasticity</h2>

    
    <p>In general, it is expected that caching will only be used when stochasticity
is not relevant, or if a user has achieved sufficient stochasticity (e.g., via
sufficient number of calls to <code>experiment</code>) such that no new explorations
of stochastic outcomes are required. It will also be very useful in a
reproducible workflow.</p>
    
    <h2 class="hasAnchor" id="-code-sideeffect-code-"><a class="anchor" href="#-code-sideeffect-code-"></a>&lt;code&gt;sideEffect&lt;/code&gt;</h2>

    
    <p>If <code>sideEffect</code> is not <code>FALSE</code>, then metadata about any files that
added to <code>sideEffect</code> will be added as an attribute to the cached copy.
Subsequent calls to this function
       will assess for the presence of the new files in the <code>sideEffect</code> location.
       If the files are identical (<code>quick = FALSE</code>) or their file size is
       identical (<code>quick = TRUE</code>), then the cached copy of the function will
       be returned (and no files changed). If there are missing or incorrect files,
       then the function will re-run. This will accommodate the situation where the
       function call is identical, but somehow the side effect files were modified.
       If <code>sideEffect</code> is logical, then the function will check the
       <code>cacheRepo</code>; if it is a path, then it will check the path. The function will
       assess whether the files to be downloaded are found locally
       prior to download. If it fails the local test, then it will try to recover from a
       local copy if (<code>makeCopy</code> had been set to <code>TRUE</code> the first time
       the function was run. Currently, local recovery will only work if<code>makeCOpy</code> was
       set to <code>TRUE</code> the first time <code>Cache</code>
       was run). Default is <code>FALSE</code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='http://www.rdocumentation.org/packages/archivist/topics/cache'>cache</a></code>, <code><a href='robustDigest.html'>.robustDigest</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>raster</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: sp</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘raster’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:reproducible’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    init</span></div><div class='input'>
<span class='no'>tmpDir</span> <span class='kw'>&lt;-</span> <span class='fu'>file.path</span>(<span class='fu'>tempdir</span>(), <span class='st'>"reproducible_examples"</span>, <span class='st'>"Cache"</span>)
<span class='fu'>try</span>(<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>), <span class='kw'>silent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># just to make sure it is clear</span>

<span class='co'># Basic use</span>
<span class='no'>ranNumsA</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>rnorm</span>, <span class='fl'>10</span>, <span class='fl'>16</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)

<span class='co'># All same</span>
<span class='no'>ranNumsB</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>rnorm</span>, <span class='fl'>10</span>, <span class='fl'>16</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>) <span class='co'># recovers cached copy</span></div><div class='output co'>#&gt; <span class='message'>  loading cached result from previous rnorm call.</span></div><div class='input'><span class='no'>ranNumsC</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fl'>10</span>, <span class='fl'>16</span>) <span class='kw'>%&gt;%</span> <span class='fu'>Cache</span>(<span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>) <span class='co'># recovers cached copy</span></div><div class='output co'>#&gt; <span class='message'>  loading cached result from previous 'rnorm' pipe sequence call.</span></div><div class='input'><span class='no'>ranNumsD</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='fu'>quote</span>(<span class='fu'>rnorm</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='fl'>16</span>)), <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>) <span class='co'># recovers cached copy</span></div><div class='output co'>#&gt; <span class='message'>  loading cached result from previous rnorm call.</span></div><div class='input'>
<span class='co'># Any minor change makes it different</span>
<span class='no'>ranNumsE</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fl'>10</span>, <span class='fl'>6</span>) <span class='kw'>%&gt;%</span> <span class='fu'>Cache</span>(<span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>) <span class='co'># different</span>

<span class='co'>## Example 1: basic cache use with tags</span>
<span class='no'>ranNumsA</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>rnorm</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:a"</span>)
<span class='no'>ranNumsB</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>runif</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:b"</span>)

<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"objectName"</span>))</div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 2d58e2618e8ef93a0a337693d7229d10         format
#&gt;  2: 2d58e2618e8ef93a0a337693d7229d10           name
#&gt;  3: 2d58e2618e8ef93a0a337693d7229d10          class
#&gt;  4: 2d58e2618e8ef93a0a337693d7229d10           date
#&gt;  5: 2d58e2618e8ef93a0a337693d7229d10     objectName
#&gt;  6: 2d58e2618e8ef93a0a337693d7229d10       function
#&gt;  7: 2d58e2618e8ef93a0a337693d7229d10    object.size
#&gt;  8: 2d58e2618e8ef93a0a337693d7229d10       accessed
#&gt;  9: 2d58e2618e8ef93a0a337693d7229d10 otherFunctions
#&gt; 10: 2d58e2618e8ef93a0a337693d7229d10 otherFunctions
#&gt; 11: 2d58e2618e8ef93a0a337693d7229d10 otherFunctions
#&gt; 12: 2d58e2618e8ef93a0a337693d7229d10        cacheId
#&gt; 13: 98d7c74270fee5196e9701c02a08081a         format
#&gt; 14: 98d7c74270fee5196e9701c02a08081a           name
#&gt; 15: 98d7c74270fee5196e9701c02a08081a          class
#&gt; 16: 98d7c74270fee5196e9701c02a08081a           date
#&gt; 17: 98d7c74270fee5196e9701c02a08081a     objectName
#&gt; 18: 98d7c74270fee5196e9701c02a08081a       function
#&gt; 19: 98d7c74270fee5196e9701c02a08081a    object.size
#&gt; 20: 98d7c74270fee5196e9701c02a08081a       accessed
#&gt; 21: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 22: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 23: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 24: 98d7c74270fee5196e9701c02a08081a        cacheId
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:38
#&gt;  2:                               Cache 2018-01-25 08:47:38
#&gt;  3:                             numeric 2018-01-25 08:47:38
#&gt;  4:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  5:                                   b 2018-01-25 08:47:38
#&gt;  6:                               runif 2018-01-25 08:47:38
#&gt;  7:                                 528 2018-01-25 08:47:38
#&gt;  8:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:38
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:38
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:38
#&gt; 12:    d89a70080574eedee9d56a2a09d7ca01 2018-01-25 08:47:38
#&gt; 13:                                 rda 2018-01-25 08:47:38
#&gt; 14:                               Cache 2018-01-25 08:47:38
#&gt; 15:                             numeric 2018-01-25 08:47:38
#&gt; 16:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt; 17:                                   a 2018-01-25 08:47:38
#&gt; 18:                               rnorm 2018-01-25 08:47:38
#&gt; 19:                                 528 2018-01-25 08:47:38
#&gt; 20:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt; 21:      otherFunctions:build_reference 2018-01-25 08:47:38
#&gt; 22: otherFunctions:data_reference_topic 2018-01-25 08:47:38
#&gt; 23:                  otherFunctions:try 2018-01-25 08:47:38
#&gt; 24:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:38
#&gt;                                tagValue         createdDate</div><div class='input'><span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"^a$"</span>)) <span class='co'># regular expression ... "a" exactly</span></div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 98d7c74270fee5196e9701c02a08081a         format
#&gt;  2: 98d7c74270fee5196e9701c02a08081a           name
#&gt;  3: 98d7c74270fee5196e9701c02a08081a          class
#&gt;  4: 98d7c74270fee5196e9701c02a08081a           date
#&gt;  5: 98d7c74270fee5196e9701c02a08081a     objectName
#&gt;  6: 98d7c74270fee5196e9701c02a08081a       function
#&gt;  7: 98d7c74270fee5196e9701c02a08081a    object.size
#&gt;  8: 98d7c74270fee5196e9701c02a08081a       accessed
#&gt;  9: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 10: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 11: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 12: 98d7c74270fee5196e9701c02a08081a        cacheId
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:38
#&gt;  2:                               Cache 2018-01-25 08:47:38
#&gt;  3:                             numeric 2018-01-25 08:47:38
#&gt;  4:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  5:                                   a 2018-01-25 08:47:38
#&gt;  6:                               rnorm 2018-01-25 08:47:38
#&gt;  7:                                 528 2018-01-25 08:47:38
#&gt;  8:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:38
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:38
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:38
#&gt; 12:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:38</div><div class='input'><span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"runif"</span>)) <span class='co'># show only cached objects made during runif call</span></div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 2d58e2618e8ef93a0a337693d7229d10         format
#&gt;  2: 2d58e2618e8ef93a0a337693d7229d10           name
#&gt;  3: 2d58e2618e8ef93a0a337693d7229d10          class
#&gt;  4: 2d58e2618e8ef93a0a337693d7229d10           date
#&gt;  5: 2d58e2618e8ef93a0a337693d7229d10     objectName
#&gt;  6: 2d58e2618e8ef93a0a337693d7229d10       function
#&gt;  7: 2d58e2618e8ef93a0a337693d7229d10    object.size
#&gt;  8: 2d58e2618e8ef93a0a337693d7229d10       accessed
#&gt;  9: 2d58e2618e8ef93a0a337693d7229d10 otherFunctions
#&gt; 10: 2d58e2618e8ef93a0a337693d7229d10 otherFunctions
#&gt; 11: 2d58e2618e8ef93a0a337693d7229d10 otherFunctions
#&gt; 12: 2d58e2618e8ef93a0a337693d7229d10        cacheId
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:38
#&gt;  2:                               Cache 2018-01-25 08:47:38
#&gt;  3:                             numeric 2018-01-25 08:47:38
#&gt;  4:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  5:                                   b 2018-01-25 08:47:38
#&gt;  6:                               runif 2018-01-25 08:47:38
#&gt;  7:                                 528 2018-01-25 08:47:38
#&gt;  8:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:38
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:38
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:38
#&gt; 12:    d89a70080574eedee9d56a2a09d7ca01 2018-01-25 08:47:38</div><div class='input'>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"runif"</span>)) <span class='co'># remove only cached objects made during runif call</span>
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>) <span class='co'># only those made during rnorm call</span></div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 8f32b763226ecc49a4aed377031cda7b         format
#&gt;  2: 8f32b763226ecc49a4aed377031cda7b           name
#&gt;  3: 8f32b763226ecc49a4aed377031cda7b          class
#&gt;  4: 8f32b763226ecc49a4aed377031cda7b           date
#&gt;  5: 8f32b763226ecc49a4aed377031cda7b       function
#&gt;  6: 8f32b763226ecc49a4aed377031cda7b    object.size
#&gt;  7: 8f32b763226ecc49a4aed377031cda7b       accessed
#&gt;  8: 8f32b763226ecc49a4aed377031cda7b otherFunctions
#&gt;  9: 8f32b763226ecc49a4aed377031cda7b otherFunctions
#&gt; 10: 8f32b763226ecc49a4aed377031cda7b otherFunctions
#&gt; 11: 8f32b763226ecc49a4aed377031cda7b        cacheId
#&gt; 12: 98d7c74270fee5196e9701c02a08081a         format
#&gt; 13: 98d7c74270fee5196e9701c02a08081a           name
#&gt; 14: 98d7c74270fee5196e9701c02a08081a          class
#&gt; 15: 98d7c74270fee5196e9701c02a08081a           date
#&gt; 16: 98d7c74270fee5196e9701c02a08081a     objectName
#&gt; 17: 98d7c74270fee5196e9701c02a08081a       function
#&gt; 18: 98d7c74270fee5196e9701c02a08081a    object.size
#&gt; 19: 98d7c74270fee5196e9701c02a08081a       accessed
#&gt; 20: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 21: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 22: 98d7c74270fee5196e9701c02a08081a otherFunctions
#&gt; 23: 98d7c74270fee5196e9701c02a08081a        cacheId
#&gt; 24: eb8e9864f48565413eceddf69996a7a3         format
#&gt; 25: eb8e9864f48565413eceddf69996a7a3           name
#&gt; 26: eb8e9864f48565413eceddf69996a7a3          class
#&gt; 27: eb8e9864f48565413eceddf69996a7a3           date
#&gt; 28: eb8e9864f48565413eceddf69996a7a3       function
#&gt; 29: eb8e9864f48565413eceddf69996a7a3    object.size
#&gt; 30: eb8e9864f48565413eceddf69996a7a3       accessed
#&gt; 31: eb8e9864f48565413eceddf69996a7a3 otherFunctions
#&gt; 32: eb8e9864f48565413eceddf69996a7a3 otherFunctions
#&gt; 33: eb8e9864f48565413eceddf69996a7a3 otherFunctions
#&gt; 34: eb8e9864f48565413eceddf69996a7a3        cacheId
#&gt; 35: eb8e9864f48565413eceddf69996a7a3       accessed
#&gt; 36: eb8e9864f48565413eceddf69996a7a3       accessed
#&gt; 37: eb8e9864f48565413eceddf69996a7a3       accessed
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:38
#&gt;  2:                               Cache 2018-01-25 08:47:38
#&gt;  3:                             numeric 2018-01-25 08:47:38
#&gt;  4:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  5:                 rnorm pipe sequence 2018-01-25 08:47:38
#&gt;  6:                                 624 2018-01-25 08:47:38
#&gt;  7:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;  8:      otherFunctions:build_reference 2018-01-25 08:47:38
#&gt;  9: otherFunctions:data_reference_topic 2018-01-25 08:47:38
#&gt; 10:                  otherFunctions:try 2018-01-25 08:47:38
#&gt; 11:    25729d525b445f9a94475253cd095f48 2018-01-25 08:47:38
#&gt; 12:                                 rda 2018-01-25 08:47:38
#&gt; 13:                               Cache 2018-01-25 08:47:38
#&gt; 14:                             numeric 2018-01-25 08:47:38
#&gt; 15:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt; 16:                                   a 2018-01-25 08:47:38
#&gt; 17:                               rnorm 2018-01-25 08:47:38
#&gt; 18:                                 528 2018-01-25 08:47:38
#&gt; 19:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt; 20:      otherFunctions:build_reference 2018-01-25 08:47:38
#&gt; 21: otherFunctions:data_reference_topic 2018-01-25 08:47:38
#&gt; 22:                  otherFunctions:try 2018-01-25 08:47:38
#&gt; 23:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:38
#&gt; 24:                                 rda 2018-01-25 08:47:37
#&gt; 25:                               Cache 2018-01-25 08:47:37
#&gt; 26:                             numeric 2018-01-25 08:47:37
#&gt; 27:                 2018-01-25 08:47:37 2018-01-25 08:47:37
#&gt; 28:                               rnorm 2018-01-25 08:47:37
#&gt; 29:                                 624 2018-01-25 08:47:37
#&gt; 30:                 2018-01-25 08:47:37 2018-01-25 08:47:37
#&gt; 31:      otherFunctions:build_reference 2018-01-25 08:47:37
#&gt; 32: otherFunctions:data_reference_topic 2018-01-25 08:47:37
#&gt; 33:                  otherFunctions:try 2018-01-25 08:47:37
#&gt; 34:    c9b9e3d462fdcd976aac998bbbc60c7a 2018-01-25 08:47:37
#&gt; 35:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt; 36:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt; 37:                 2018-01-25 08:47:38 2018-01-25 08:47:38
#&gt;                                tagValue         createdDate</div><div class='input'>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>)

<span class='co'>## Example 2: using the "accessed" tag</span>
<span class='no'>ranNumsA</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>rnorm</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:a"</span>)
<span class='no'>ranNumsB</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>runif</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:b"</span>)

<span class='co'># access it again, from Cache</span>
<span class='no'>ranNumsA</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>rnorm</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:a"</span>)</div><div class='output co'>#&gt; <span class='message'>  loading cached result from previous rnorm call.</span></div><div class='input'><span class='no'>wholeCache</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>)

<span class='co'># keep only items accessed "recently" (i.e., only objectName:a)</span>
<span class='no'>onlyRecentlyAccessed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>max</span>(<span class='no'>wholeCache</span>[<span class='no'>tagKey</span> <span class='kw'>==</span> <span class='st'>"accessed"</span>]$<span class='no'>tagValue</span>))

<span class='co'># inverse join with 2 data.tables ... using: a[!b]</span>
<span class='co'># i.e., return all of wholeCache that was not recently accessed</span>
<span class='no'>toRemove</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/unique'>unique</a></span>(<span class='no'>wholeCache</span>[!<span class='no'>onlyRecentlyAccessed</span>], <span class='kw'>by</span> <span class='kw'>=</span> <span class='st'>"artifact"</span>)$<span class='no'>artifact</span>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>, <span class='no'>toRemove</span>) <span class='co'># remove ones not recently accessed</span>
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>) <span class='co'># still has more recently accessed</span></div><div class='output co'>#&gt; Empty data.table (0 rows) of 3 cols: md5hash,name,createdDate</div><div class='input'>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>)

<span class='co'>## Example 3: using keepCache</span>
<span class='no'>ranNumsA</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>rnorm</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:a"</span>)
<span class='no'>ranNumsB</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>runif</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:b"</span>)

<span class='co'># keep only those cached items from the last 24 hours</span>
<span class='no'>oneDay</span> <span class='kw'>&lt;-</span> <span class='fl'>60</span> * <span class='fl'>60</span> * <span class='fl'>24</span>
<span class='fu'><a href='viewCache.html'>keepCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>after</span> <span class='kw'>=</span> <span class='fu'>Sys.time</span>() - <span class='no'>oneDay</span>)</div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 032db0f6aea3114b467dbbbfa6d8c0bf         format
#&gt;  2: 032db0f6aea3114b467dbbbfa6d8c0bf           name
#&gt;  3: 032db0f6aea3114b467dbbbfa6d8c0bf          class
#&gt;  4: 032db0f6aea3114b467dbbbfa6d8c0bf           date
#&gt;  5: 032db0f6aea3114b467dbbbfa6d8c0bf     objectName
#&gt;  6: 032db0f6aea3114b467dbbbfa6d8c0bf       function
#&gt;  7: 032db0f6aea3114b467dbbbfa6d8c0bf    object.size
#&gt;  8: 032db0f6aea3114b467dbbbfa6d8c0bf       accessed
#&gt;  9: 032db0f6aea3114b467dbbbfa6d8c0bf otherFunctions
#&gt; 10: 032db0f6aea3114b467dbbbfa6d8c0bf otherFunctions
#&gt; 11: 032db0f6aea3114b467dbbbfa6d8c0bf otherFunctions
#&gt; 12: 032db0f6aea3114b467dbbbfa6d8c0bf        cacheId
#&gt; 13: 5a59a3ff316978f926ed7ca36431fd16         format
#&gt; 14: 5a59a3ff316978f926ed7ca36431fd16           name
#&gt; 15: 5a59a3ff316978f926ed7ca36431fd16          class
#&gt; 16: 5a59a3ff316978f926ed7ca36431fd16           date
#&gt; 17: 5a59a3ff316978f926ed7ca36431fd16     objectName
#&gt; 18: 5a59a3ff316978f926ed7ca36431fd16       function
#&gt; 19: 5a59a3ff316978f926ed7ca36431fd16    object.size
#&gt; 20: 5a59a3ff316978f926ed7ca36431fd16       accessed
#&gt; 21: 5a59a3ff316978f926ed7ca36431fd16 otherFunctions
#&gt; 22: 5a59a3ff316978f926ed7ca36431fd16 otherFunctions
#&gt; 23: 5a59a3ff316978f926ed7ca36431fd16 otherFunctions
#&gt; 24: 5a59a3ff316978f926ed7ca36431fd16        cacheId
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:39
#&gt;  2:                               Cache 2018-01-25 08:47:39
#&gt;  3:                             numeric 2018-01-25 08:47:39
#&gt;  4:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt;  5:                                   a 2018-01-25 08:47:39
#&gt;  6:                               rnorm 2018-01-25 08:47:39
#&gt;  7:                                 528 2018-01-25 08:47:39
#&gt;  8:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:39
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:39
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:39
#&gt; 12:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:39
#&gt; 13:                                 rda 2018-01-25 08:47:39
#&gt; 14:                               Cache 2018-01-25 08:47:39
#&gt; 15:                             numeric 2018-01-25 08:47:39
#&gt; 16:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 17:                                   b 2018-01-25 08:47:39
#&gt; 18:                               runif 2018-01-25 08:47:39
#&gt; 19:                                 528 2018-01-25 08:47:39
#&gt; 20:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 21:      otherFunctions:build_reference 2018-01-25 08:47:39
#&gt; 22: otherFunctions:data_reference_topic 2018-01-25 08:47:39
#&gt; 23:                  otherFunctions:try 2018-01-25 08:47:39
#&gt; 24:    d89a70080574eedee9d56a2a09d7ca01 2018-01-25 08:47:39
#&gt;                                tagValue         createdDate</div><div class='input'>
<span class='co'># Keep all Cache items created with an rnorm() call</span>
<span class='fu'><a href='viewCache.html'>keepCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"rnorm"</span>)</div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 032db0f6aea3114b467dbbbfa6d8c0bf         format
#&gt;  2: 032db0f6aea3114b467dbbbfa6d8c0bf           name
#&gt;  3: 032db0f6aea3114b467dbbbfa6d8c0bf          class
#&gt;  4: 032db0f6aea3114b467dbbbfa6d8c0bf           date
#&gt;  5: 032db0f6aea3114b467dbbbfa6d8c0bf     objectName
#&gt;  6: 032db0f6aea3114b467dbbbfa6d8c0bf       function
#&gt;  7: 032db0f6aea3114b467dbbbfa6d8c0bf    object.size
#&gt;  8: 032db0f6aea3114b467dbbbfa6d8c0bf       accessed
#&gt;  9: 032db0f6aea3114b467dbbbfa6d8c0bf otherFunctions
#&gt; 10: 032db0f6aea3114b467dbbbfa6d8c0bf otherFunctions
#&gt; 11: 032db0f6aea3114b467dbbbfa6d8c0bf otherFunctions
#&gt; 12: 032db0f6aea3114b467dbbbfa6d8c0bf        cacheId
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:39
#&gt;  2:                               Cache 2018-01-25 08:47:39
#&gt;  3:                             numeric 2018-01-25 08:47:39
#&gt;  4:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt;  5:                                   a 2018-01-25 08:47:39
#&gt;  6:                               rnorm 2018-01-25 08:47:39
#&gt;  7:                                 528 2018-01-25 08:47:39
#&gt;  8:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:39
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:39
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:39
#&gt; 12:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:39</div><div class='input'>
<span class='co'># Remove all Cache items that happened within a rnorm() call</span>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"rnorm"</span>)

<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>) <span class='co'>## empty</span></div><div class='output co'>#&gt; Empty data.table (0 rows) of 3 cols: md5hash,name,createdDate</div><div class='input'>
<span class='co'>## Example 4: searching for multiple objects in the cache</span>

<span class='co'># default userTags is "and" matching; for "or" matching use |</span>
<span class='no'>ranNumsA</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>runif</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:a"</span>)
<span class='no'>ranNumsB</span> <span class='kw'>&lt;-</span> <span class='fu'>Cache</span>(<span class='no'>rnorm</span>, <span class='fl'>4</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"objectName:b"</span>)

<span class='co'># show all objects (runif and rnorm in this case)</span>
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>)</div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 9632d7d9cdb4bcb11c7f62021d342a90         format
#&gt;  2: 9632d7d9cdb4bcb11c7f62021d342a90           name
#&gt;  3: 9632d7d9cdb4bcb11c7f62021d342a90          class
#&gt;  4: 9632d7d9cdb4bcb11c7f62021d342a90           date
#&gt;  5: 9632d7d9cdb4bcb11c7f62021d342a90     objectName
#&gt;  6: 9632d7d9cdb4bcb11c7f62021d342a90       function
#&gt;  7: 9632d7d9cdb4bcb11c7f62021d342a90    object.size
#&gt;  8: 9632d7d9cdb4bcb11c7f62021d342a90       accessed
#&gt;  9: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 10: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 11: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 12: 9632d7d9cdb4bcb11c7f62021d342a90        cacheId
#&gt; 13: de8432ac8f988025e51f60e237bd4e2c         format
#&gt; 14: de8432ac8f988025e51f60e237bd4e2c           name
#&gt; 15: de8432ac8f988025e51f60e237bd4e2c          class
#&gt; 16: de8432ac8f988025e51f60e237bd4e2c           date
#&gt; 17: de8432ac8f988025e51f60e237bd4e2c     objectName
#&gt; 18: de8432ac8f988025e51f60e237bd4e2c       function
#&gt; 19: de8432ac8f988025e51f60e237bd4e2c    object.size
#&gt; 20: de8432ac8f988025e51f60e237bd4e2c       accessed
#&gt; 21: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 22: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 23: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 24: de8432ac8f988025e51f60e237bd4e2c        cacheId
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:40
#&gt;  2:                               Cache 2018-01-25 08:47:40
#&gt;  3:                             numeric 2018-01-25 08:47:40
#&gt;  4:                 2018-01-25 08:47:40 2018-01-25 08:47:40
#&gt;  5:                                   b 2018-01-25 08:47:40
#&gt;  6:                               rnorm 2018-01-25 08:47:40
#&gt;  7:                                 528 2018-01-25 08:47:40
#&gt;  8:                 2018-01-25 08:47:40 2018-01-25 08:47:40
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:40
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:40
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:40
#&gt; 12:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:40
#&gt; 13:                                 rda 2018-01-25 08:47:39
#&gt; 14:                               Cache 2018-01-25 08:47:39
#&gt; 15:                             numeric 2018-01-25 08:47:39
#&gt; 16:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 17:                                   a 2018-01-25 08:47:39
#&gt; 18:                               runif 2018-01-25 08:47:39
#&gt; 19:                                 528 2018-01-25 08:47:39
#&gt; 20:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 21:      otherFunctions:build_reference 2018-01-25 08:47:39
#&gt; 22: otherFunctions:data_reference_topic 2018-01-25 08:47:40
#&gt; 23:                  otherFunctions:try 2018-01-25 08:47:40
#&gt; 24:    d89a70080574eedee9d56a2a09d7ca01 2018-01-25 08:47:40
#&gt;                                tagValue         createdDate</div><div class='input'>
<span class='co'># show objects that are both runif and rnorm</span>
<span class='co'># (i.e., none in this case, because objecs are either or, not both)</span>
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"runif"</span>, <span class='st'>"rnorm"</span>)) <span class='co'>## empty</span></div><div class='output co'>#&gt; Empty data.table (0 rows) of 4 cols: artifact,tagKey,tagValue,createdDate</div><div class='input'>
<span class='co'># show objects that are either runif or rnorm ("or" search)</span>
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"runif|rnorm"</span>)</div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 9632d7d9cdb4bcb11c7f62021d342a90         format
#&gt;  2: 9632d7d9cdb4bcb11c7f62021d342a90           name
#&gt;  3: 9632d7d9cdb4bcb11c7f62021d342a90          class
#&gt;  4: 9632d7d9cdb4bcb11c7f62021d342a90           date
#&gt;  5: 9632d7d9cdb4bcb11c7f62021d342a90     objectName
#&gt;  6: 9632d7d9cdb4bcb11c7f62021d342a90       function
#&gt;  7: 9632d7d9cdb4bcb11c7f62021d342a90    object.size
#&gt;  8: 9632d7d9cdb4bcb11c7f62021d342a90       accessed
#&gt;  9: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 10: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 11: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 12: 9632d7d9cdb4bcb11c7f62021d342a90        cacheId
#&gt; 13: de8432ac8f988025e51f60e237bd4e2c         format
#&gt; 14: de8432ac8f988025e51f60e237bd4e2c           name
#&gt; 15: de8432ac8f988025e51f60e237bd4e2c          class
#&gt; 16: de8432ac8f988025e51f60e237bd4e2c           date
#&gt; 17: de8432ac8f988025e51f60e237bd4e2c     objectName
#&gt; 18: de8432ac8f988025e51f60e237bd4e2c       function
#&gt; 19: de8432ac8f988025e51f60e237bd4e2c    object.size
#&gt; 20: de8432ac8f988025e51f60e237bd4e2c       accessed
#&gt; 21: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 22: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 23: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 24: de8432ac8f988025e51f60e237bd4e2c        cacheId
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:40
#&gt;  2:                               Cache 2018-01-25 08:47:40
#&gt;  3:                             numeric 2018-01-25 08:47:40
#&gt;  4:                 2018-01-25 08:47:40 2018-01-25 08:47:40
#&gt;  5:                                   b 2018-01-25 08:47:40
#&gt;  6:                               rnorm 2018-01-25 08:47:40
#&gt;  7:                                 528 2018-01-25 08:47:40
#&gt;  8:                 2018-01-25 08:47:40 2018-01-25 08:47:40
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:40
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:40
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:40
#&gt; 12:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:40
#&gt; 13:                                 rda 2018-01-25 08:47:39
#&gt; 14:                               Cache 2018-01-25 08:47:39
#&gt; 15:                             numeric 2018-01-25 08:47:39
#&gt; 16:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 17:                                   a 2018-01-25 08:47:39
#&gt; 18:                               runif 2018-01-25 08:47:39
#&gt; 19:                                 528 2018-01-25 08:47:39
#&gt; 20:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 21:      otherFunctions:build_reference 2018-01-25 08:47:39
#&gt; 22: otherFunctions:data_reference_topic 2018-01-25 08:47:40
#&gt; 23:                  otherFunctions:try 2018-01-25 08:47:40
#&gt; 24:    d89a70080574eedee9d56a2a09d7ca01 2018-01-25 08:47:40
#&gt;                                tagValue         createdDate</div><div class='input'>
<span class='co'># keep only objects that are either runif or rnorm ("or" search)</span>
<span class='fu'><a href='viewCache.html'>keepCache</a></span>(<span class='no'>tmpDir</span>, <span class='kw'>userTags</span> <span class='kw'>=</span> <span class='st'>"runif|rnorm"</span>)</div><div class='output co'>#&gt;                             artifact         tagKey
#&gt;  1: 9632d7d9cdb4bcb11c7f62021d342a90         format
#&gt;  2: 9632d7d9cdb4bcb11c7f62021d342a90           name
#&gt;  3: 9632d7d9cdb4bcb11c7f62021d342a90          class
#&gt;  4: 9632d7d9cdb4bcb11c7f62021d342a90           date
#&gt;  5: 9632d7d9cdb4bcb11c7f62021d342a90     objectName
#&gt;  6: 9632d7d9cdb4bcb11c7f62021d342a90       function
#&gt;  7: 9632d7d9cdb4bcb11c7f62021d342a90    object.size
#&gt;  8: 9632d7d9cdb4bcb11c7f62021d342a90       accessed
#&gt;  9: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 10: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 11: 9632d7d9cdb4bcb11c7f62021d342a90 otherFunctions
#&gt; 12: 9632d7d9cdb4bcb11c7f62021d342a90        cacheId
#&gt; 13: de8432ac8f988025e51f60e237bd4e2c         format
#&gt; 14: de8432ac8f988025e51f60e237bd4e2c           name
#&gt; 15: de8432ac8f988025e51f60e237bd4e2c          class
#&gt; 16: de8432ac8f988025e51f60e237bd4e2c           date
#&gt; 17: de8432ac8f988025e51f60e237bd4e2c     objectName
#&gt; 18: de8432ac8f988025e51f60e237bd4e2c       function
#&gt; 19: de8432ac8f988025e51f60e237bd4e2c    object.size
#&gt; 20: de8432ac8f988025e51f60e237bd4e2c       accessed
#&gt; 21: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 22: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 23: de8432ac8f988025e51f60e237bd4e2c otherFunctions
#&gt; 24: de8432ac8f988025e51f60e237bd4e2c        cacheId
#&gt;                             artifact         tagKey
#&gt;                                tagValue         createdDate
#&gt;  1:                                 rda 2018-01-25 08:47:40
#&gt;  2:                               Cache 2018-01-25 08:47:40
#&gt;  3:                             numeric 2018-01-25 08:47:40
#&gt;  4:                 2018-01-25 08:47:40 2018-01-25 08:47:40
#&gt;  5:                                   b 2018-01-25 08:47:40
#&gt;  6:                               rnorm 2018-01-25 08:47:40
#&gt;  7:                                 528 2018-01-25 08:47:40
#&gt;  8:                 2018-01-25 08:47:40 2018-01-25 08:47:40
#&gt;  9:      otherFunctions:build_reference 2018-01-25 08:47:40
#&gt; 10: otherFunctions:data_reference_topic 2018-01-25 08:47:40
#&gt; 11:                  otherFunctions:try 2018-01-25 08:47:40
#&gt; 12:    f05172cef0faa451e18d7ddc500dbd0e 2018-01-25 08:47:40
#&gt; 13:                                 rda 2018-01-25 08:47:39
#&gt; 14:                               Cache 2018-01-25 08:47:39
#&gt; 15:                             numeric 2018-01-25 08:47:39
#&gt; 16:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 17:                                   a 2018-01-25 08:47:39
#&gt; 18:                               runif 2018-01-25 08:47:39
#&gt; 19:                                 528 2018-01-25 08:47:39
#&gt; 20:                 2018-01-25 08:47:39 2018-01-25 08:47:39
#&gt; 21:      otherFunctions:build_reference 2018-01-25 08:47:39
#&gt; 22: otherFunctions:data_reference_topic 2018-01-25 08:47:40
#&gt; 23:                  otherFunctions:try 2018-01-25 08:47:40
#&gt; 24:    d89a70080574eedee9d56a2a09d7ca01 2018-01-25 08:47:40
#&gt;                                tagValue         createdDate</div><div class='input'>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>)

<span class='co'>## Example 5: using caching to speed up rerunning expensive computations</span>
<span class='no'>ras</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/extent'>extent</a></span>(<span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>0</span>, <span class='fl'>10</span>), <span class='kw'>res</span> <span class='kw'>=</span> <span class='fl'>1</span>,
              <span class='kw'>vals</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1e2</span>),
              <span class='kw'>crs</span> <span class='kw'>=</span> <span class='st'>"+proj=lcc +lat_1=48 +lat_2=33 +lon_0=-100 +ellps=WGS84"</span>)

<span class='co'># A slow operation, like GIS operation</span>
<span class='no'>notCached</span> <span class='kw'>&lt;-</span> <span class='fu'>suppressWarnings</span>(
  <span class='co'># project raster generates warnings when run non-interactively</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/projectRaster'>projectRaster</a></span>(<span class='no'>ras</span>, <span class='kw'>crs</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>ras</span>), <span class='kw'>res</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)
)

<span class='no'>cached</span> <span class='kw'>&lt;-</span> <span class='fu'>suppressWarnings</span>(
  <span class='co'># project raster generates warnings when run non-interactively</span>
  <span class='fu'>Cache</span>(<span class='no'>projectRaster</span>, <span class='no'>ras</span>, <span class='kw'>crs</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>ras</span>), <span class='kw'>res</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)
)

<span class='co'># second time is much faster</span>
<span class='no'>reRun</span> <span class='kw'>&lt;-</span> <span class='fu'>suppressWarnings</span>(
  <span class='co'># project raster generates warnings when run non-interactively</span>
  <span class='fu'>Cache</span>(<span class='no'>projectRaster</span>, <span class='no'>ras</span>, <span class='kw'>crs</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>ras</span>), <span class='kw'>res</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)
)</div><div class='output co'>#&gt; <span class='message'>  loading cached result from previous projectRaster call.</span></div><div class='input'>
<span class='co'># recovered cached version is same as non-cached version</span>
<span class='fu'>all.equal</span>(<span class='no'>notCached</span>, <span class='no'>reRun</span>) <span class='co'>## TRUE</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'>## Example 6: working with file paths</span>

<span class='co'># if passing a character string, it will take 2 complete passes to before</span>
<span class='co'>#  a cached copy is used when it is a save event (read or load is different)</span>
<span class='no'>obj</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='fl'>10</span>
<span class='no'>fname</span> <span class='kw'>&lt;-</span> <span class='fu'>tempfile</span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".RData"</span>)
<span class='fu'>Cache</span>(<span class='no'>saveRDS</span>, <span class='no'>obj</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='no'>fname</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)</div><div class='output co'>#&gt; NULL</div><div class='input'><span class='fu'>Cache</span>(<span class='no'>saveRDS</span>, <span class='no'>obj</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='no'>fname</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)</div><div class='output co'>#&gt; NULL</div><div class='input'><span class='fu'>Cache</span>(<span class='no'>saveRDS</span>, <span class='no'>obj</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='no'>fname</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>) <span class='co'># cached copy is loaded</span></div><div class='output co'>#&gt; <span class='message'>  loading cached result from previous saveRDS call.</span></div><div class='output co'>#&gt; [1] "NULL"
#&gt; attr(,"tags")
#&gt; [1] "cacheId:256e9b67000fa93742bffc0f38015cea"
#&gt; attr(,"call")
#&gt; [1] ""</div><div class='input'>
<span class='co'># however, using asPath(), cached version retrieved after being run once</span>
<span class='no'>fname1</span> <span class='kw'>&lt;-</span> <span class='fu'>tempfile</span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".RData"</span>)
<span class='fu'>Cache</span>(<span class='no'>saveRDS</span>, <span class='no'>obj</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='fu'>asPath</span>(<span class='no'>fname1</span>), <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)</div><div class='output co'>#&gt; NULL</div><div class='input'><span class='fu'>Cache</span>(<span class='no'>saveRDS</span>, <span class='no'>obj</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='fu'>asPath</span>(<span class='no'>fname1</span>), <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>) <span class='co'># cached copy is loaded</span></div><div class='output co'>#&gt; NULL</div><div class='input'>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>)

<span class='co'>## cleanup</span>
<span class='fu'>unlink</span>(<span class='fu'>c</span>(<span class='st'>"filename.rda"</span>, <span class='st'>"filename1.rda"</span>))
<span class='fu'>unlink</span>(<span class='fu'>dirname</span>(<span class='no'>tmpDir</span>), <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#filepaths">Filepaths</a></li>

      <li><a href="#stochasticity">Stochasticity</a></li>

      <li><a href="#-code-sideeffect-code-">&lt;code&gt;sideEffect&lt;/code&gt;</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Eliot McIntire

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
